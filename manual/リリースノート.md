version 3.0.4a リリース

1. slist{1,2,3}.each { "ABC"[TAB]で補完がIntegerになってましたが、修正しています。

# 言語仕様の変更点

2017年11月7日<br>
サイドバーのリリースノート見てください。そちらにまとめて書くようにします。

2017年10/27<br>
コアライブラリの上書きしたソースファイルのコンパイル時に-no-load-fundamental-clasessという引数が必要でしたが-coreにしました。
ちょっと長かったので、、、。
一応-no-load-fundamental-classesという引数も残してあります。<br>

2017年10/11<br>
ブロックが block { a := 123 } などから { a := 123 } に変更されています。ブロックは戻り値を返すようになりました。最後に実行された式の値がブロックの戻り値です。a := { 123 }; System.assert(a == 123)は真です。<br>
ブロックの表記が変わったので配列の表記が変わってます。 { 1, 2, 3 }から[ 1, 2, 3 ]となっています。リストなどはlist { 1, 2, 3 }から変わっていません。<br>
if文が戻り値を返すようになりました。a := if(true) { 123}; System.assert( a == 123 )は真です。<br>
変更申し訳ないです。<br>

2017年10/2<br>
String.subのブロックの引数が2つ目から末尾になっています。ブロックの糖衣構文に対応するためです。すみません。あとブロックを引数に取るsplitでgroup_string:Array<String>のブロックの引数は廃止されています。意味が無いためです。<br>

2017/8/14<br>
LLVMでのJITの高速化が完成しました。3倍くらいの速度がでます。詳しくは上のブログを読んで下さい。

2017/5/30<br>
LLVMでJITできるようになってます。

2017/03/21<br>
LLVMでJITをしようとしています。とりあえず、LLVMのtutorialでLLVMを学んでいます。1年くらいかけるつもりで、のんびりと進めていきます。
とりあえず、僕の遅いサーバーでp"src/".glob("*.c").grep(/main/)が3秒程度、3000行のテキストのsplitが1秒以下を目指しています。
あとはヒープのアルゴリズムの改良とかですかね。とにかく、処理速度が遅いので、改善したいと思います。
インタプリタが便利なので、ぜひ--with-interpreterをつけてコンパイルしてください。もしかするとシェルの代わりとして使えるかもしれません。Signal Interruptの判定コードが付加されますが、それほどの速度低下はありません。

2017/04/05<br>
LLVMでJITできるように開発を進めています。./configure --with-jitとするとJITが有効になりますが、まだ加算や文字列の生成くらいしか実装していません。あと./configure --with-optimizeがバグってましたが、修正しています。--with-optimizeが有効になるとLLVMを使わなくても3000行のテキストのsplitが1秒以下になりました。最適化万歳。p"src/".glob("*.c").grep(/main/)は相変わらず13秒程度かかります。JITに期待ですね。JITの開発は軌道に乗ってきています。method定義にjitオプションをつけるとmethodがJITされるようになります。

# ブログ

開発日誌書いてます。<br>
リンクはこちら→ <a href="http://daisukeminato.hatenablog.jp">Clover2開発日誌</a><br>
